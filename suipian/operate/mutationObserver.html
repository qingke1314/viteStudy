<div id="container">
</div>
<button id="update">
  改变
</button>
<style>
  #container {
    background-color: rebeccapurple;
  }
</style>
<script>
  // 兼容不同浏览器获取构造函数
  const MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
  const options = {
    attributes: true,
    characterData: true,
    childList: true,
    subtree: false,
    attributeOldValue: true, // 是否记录变动前的值
    characterDataOldValue: true,
    // attributeFilter: ['src'], // 自定义监听属性，如src、class等
  }
  const container = document.getElementById('container')
  const button = document.getElementById('update')
  // 创建MutationObserver实例，返回一个观察者对象
  const mutation = new MutationObserver((mutationRecords, observeInstance) => {
    console.log('变动记录 >>>', mutationRecords);
    // type：观察的变动类型（attribute、characterData或者childList）。
    // target：发生变动的DOM节点。
    // addedNodes：新增的DOM节点。
    // removedNodes：删除的DOM节点。
    // previousSibling：前一个同级节点，如果没有则返回null。
    // nextSibling：下一个同级节点，如果没有则返回null。
    // attributeName：发生变动的属性。如果设置了attributeFilter，则只返回预先指定的属性。
    // oldValue：变动前的值。这个属性只对attribute和characterData变动有效，如果发生childList变动，则返回null。
    console.log(Object.keys(observeInstance.__proto__));
  });
  // 对观察者添加需要观察的元素，并设置需要观察元素的哪些方面
  mutation.observe(container, options);
  // 对container进行操作
  button.addEventListener('click', function() {
    // container.innerText = '这是文本';  // 内容改变
    container.style.height = '100px'; // 属性改变
  })
</script>
