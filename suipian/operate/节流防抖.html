<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
</head>
<body>
  <h1 id="count"></h1>
  <button id="add_btn">加1</button>
  间隔：<input id="input" />
  <button id="confirm_btn">确定</button>
</body>
<script src="./simpleWatch.js"></script>
<!-- 防抖 延时触发，最后一次点的时间+n才执行-->
<script>
  function debounce(fn, time = 0) {
    var timer = null;
    return function() {
      clearTimeout(timer)
      timer = setTimeout(() => {
        fn.call(this, ...arguments)
      }, time)
    }
  }
</script>
<!-- 节流 第一次直接触发，然后n秒内无效 -->
<script>
  function throttle(fn, time = 0) {
    var valve = true
    return function() {
      if(valve) {
        fn.call(this, ...arguments)
        setTimeout(() => {
          valve = true
        }, time)
        valve = false
      }
    }
  }
</script>
<script>
  var dataSet = {
    count: 0
  }
  var countContent = document.querySelector('#count')
  addWatch(dataSet, {
    count: {
      self: () => { countContent.innerText = dataSet.count }
    }
  })
  var addBtn = document.querySelector('#add_btn')
  var input = document.querySelector('#input')
  var confirmBtn = document.querySelector('#confirm_btn')
  confirmBtn.onclick = debounce(function() {
    dataSet.count = Number(input.value)
  }, 100)
  addBtn.onclick = throttle(function() {
    dataSet.count += 1
  }, 100)
</script>